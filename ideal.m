clear
clc
t=0:1:640;
v=zeros(1,641);
a=zeros(1,641);
s=zeros(1,641);
i=1;
%匀加速阶段
while(v(i)<13.8)
    a(i)=2.1;
    i=i+1;
    v(i)=v(i-1)+a(i-1);
    s(i)=s(i-1)+v(i-1)+0.5*a(i);
end
%到达额定功率，但还在加速
while(v(i)<83.3)
    F=11097/v(i);
    anti=0.88+0.00744*3.6*v(i)+0.000114*12.96*v(i)*v(i);
    a(i)=(F-anti)/345;
     i=i+1;
    v(i)=v(i-1)+a(i-1);
    s(i)=s(i-1)+v(i-1)+0.5*a(i);
end
%匀速行驶
for j=1:174
    a(i)=0;
    i=i+1;
    v(i)=v(i-1);
    s(i)=s(i-1)+v(i-1);
end
%再生制动
while(v(i)>27.8)
    B=0.0038*v(i)*v(i)*12.96-1.8378*v(i)*3.6+646;
    anti=0.88+0.00744*3.6*v(i)+0.000114*12.96*v(i)*v(i);
    a(i)=(B+anti)/345;
    i=i+1;
    v(i)=v(i-1)-a(i-1);
    s(i)=s(i-1)+v(i-1)-0.5*a(i);
end
%空气制动
while(v(i)>0)
    B=0.0608*v(i)*3.6+493.93 ;
    anti=0.88+0.00744*3.6*v(i)+0.000114*12.96*v(i)*v(i);
    a(i)=(B+anti)/345;
    i=i+1;
    v(i)=v(i-1)-a(i-1);
    s(i)=s(i-1)+v(i-1)-0.5*a(i);
end
subplot(3,1,1);
plot(t,v);
subplot(3,1,2);
plot(t,a);
subplot(3,1,3);
plot(t,s)

